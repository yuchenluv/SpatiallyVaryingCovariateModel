
```{julia}


using CairoMakie
using Makie.FileIO


```

```{julia}
# main references
# https://docs.makie.org/v0.21/tutorials/layout-tutorial
# https://docs.makie.org/dev/reference/blocks/gridlayout

using CairoMakie
using Makie.FileIO

point_df = raw_stations
title_name = ""
range_rl = (5, 15.5)
range_change = (10, 35)
color_rl = :roma25
color_change = :BuPu

f = Figure(resolution = (2500, 800), fontsize=25)

states = download(
    "https://raw.githubusercontent.com/PublicaMundi/MappingAPI/master/data/geojson/us-states.json",
)
states_geo = GeoJSON.read(read(states, String))

Δ = 0.25
lonlims = (minimum(point_df[!, :lon]) - Δ, maximum(point_df[!, :lon]) + Δ)
latlims = (minimum(point_df[!, :lat]) - Δ, maximum(point_df[!, :lat]) + Δ)

ga = f[1, 1] = GridLayout()
gb = f[2, 1] = GridLayout()

ax1a = GeoAxis(
        ga[1, 1];
        dest="+proj=eqc",
        title="10 year",
        lonlims=lonlims,
        latlims=latlims,
        ylabel = "2022",
        yticks = [29, 30, 31],
        width = 2500/3-85,
        height = 800/3-50
    )
poly!(ax1a, states_geo; color=:white, strokewidth=1)
CairoMakie.scatter!(ax1a, raw_stations[!, :lon], raw_stations[!, :lat]; color=mean_stations_10_all_2022, colormap=color_rl, colorrange=range_rl, markersize=20, strokewidth=0, strokecolor=:grey17)
hidexdecorations!(ax1a, grid = false)

ax2a = GeoAxis(
        ga[1, 2];
        dest="+proj=eqc",
        title="50 year",
        lonlims=lonlims,
        latlims=latlims,
        yticks = [29, 30, 31],
        width = 2500/3-85,
        height = 800/3-50
    )
poly!(ax2a, states_geo; color=:white, strokewidth=1)
CairoMakie.scatter!(ax2a, raw_stations[!, :lon], raw_stations[!, :lat]; color=mean_stations_50_all_2022, colormap=color_rl, colorrange=range_rl, markersize=20, strokewidth=0, strokecolor=:grey17)
hidexdecorations!(ax2a, grid = false)
hideydecorations!(ax2a, grid = false)

ax3a = GeoAxis(
        ga[1, 3];
        dest="+proj=eqc",
        title="100 year",
        lonlims=lonlims,
        latlims=latlims,
        yticks = [29, 30, 31]
    )
poly!(ax3a, states_geo; color=:white, strokewidth=1)
CairoMakie.scatter!(ax3a, raw_stations[!, :lon], raw_stations[!, :lat]; color=mean_stations_100_all_2022, colormap=color_rl, colorrange=range_rl, markersize=20, strokewidth=0, strokecolor=:grey17)
hidexdecorations!(ax3a, grid = false)
hideydecorations!(ax3a, grid = false)

ax1b = GeoAxis(
        ga[2, 1];
        dest="+proj=eqc",
        title=title_name,
        lonlims=lonlims,
        latlims=latlims, 
        ylabel = "1940",
        yticks = [29, 30, 31]
)
poly!(ax1b, states_geo; color=:white, strokewidth=1)
CairoMakie.scatter!(ax1b, raw_stations[!, :lon], raw_stations[!, :lat]; color=mean_stations_10_all_1940, colormap=color_rl, colorrange=range_rl, markersize=20, strokewidth=0, strokecolor=:grey17)
hidexdecorations!(ax1b, grid = false)

ax2b = GeoAxis(
        ga[2, 2];
        dest="+proj=eqc",
        title=title_name,
        lonlims=lonlims,
        latlims=latlims
    )
poly!(ax2b, states_geo; color=:white, strokewidth=1)
CairoMakie.scatter!(ax2b, raw_stations[!, :lon], raw_stations[!, :lat]; color=mean_stations_50_all_1940, colormap=color_rl, colorrange=range_rl, markersize=20, strokewidth=0, strokecolor=:grey17)
hidexdecorations!(ax2b, grid = false)
hideydecorations!(ax2b, grid = false)

ax3b = GeoAxis(
        ga[2, 3];
        dest="+proj=eqc",
        title=title_name,
        lonlims=lonlims,
        latlims=latlims
)
poly!(ax3b, states_geo; color=:white, strokewidth=1)
CairoMakie.scatter!(ax3b, raw_stations[!, :lon], raw_stations[!, :lat]; color=mean_stations_100_all_1940, colormap=color_rl, colorrange=range_rl, markersize=20, strokewidth=0, strokecolor=:grey17)
hidexdecorations!(ax3b, grid = false)
hideydecorations!(ax3b, grid = false)

cb1 = Colorbar(f[1, 2], h1, label = "inches/d")

ax1c = GeoAxis(
        gb[1, 1];
        dest="+proj=eqc",
        title=title_name,
        lonlims=lonlims,
        latlims=latlims, 
        ylabel = "Difference",
        yticks = [29, 30, 31],
        width = 2500/3-85,
    )
poly!(ax1c, states_geo; color=:white, strokewidth=1)
h2 = CairoMakie.scatter!(ax1c, raw_stations[!, :lon], raw_stations[!, :lat]; color=(mean_stations_10_all_2022 .- mean_stations_10_all_1940) ./ mean_stations_10_all_1940 .* 100, colormap=color_change, colorrange=range_change, markersize=20, strokewidth=0, strokecolor=:grey17)

ax2c = GeoAxis(
        gb[1, 2];
        dest="+proj=eqc",
        title=title_name,
        lonlims=lonlims,
        latlims=latlims
    )
poly!(ax2c, states_geo; color=:white, strokewidth=1)
CairoMakie.scatter!(ax2c, raw_stations[!, :lon], raw_stations[!, :lat]; color=(mean_stations_50_all_2022 .- mean_stations_50_all_1940) ./ mean_stations_50_all_1940 .* 100, colormap=color_change, colorrange=range_change, markersize=20, strokewidth=0, strokecolor=:grey17)
hideydecorations!(ax2c, grid = false)

ax3c = GeoAxis(
        gb[1, 3];
        dest="+proj=eqc",
        title=title_name,
        lonlims=lonlims,
        latlims=latlims
    )
poly!(ax3c, states_geo; color=:white, strokewidth=1)
CairoMakie.scatter!(ax3c, raw_stations[!, :lon], raw_stations[!, :lat]; color=(mean_stations_100_all_2022 .- mean_stations_100_all_1940) ./ mean_stations_100_all_1940 .* 100, colormap=color_change, colorrange=range_change, markersize=20, strokewidth=0, strokecolor=:grey17)
hideydecorations!(ax3c, grid = false)

cb2 = Colorbar(f[2, 2], h2, label = "%")

rowsize!(f.layout, 1, Relative(199/300))
colsize!(f.layout, 1, Relative(1))
resize_to_layout!(f)

# linkxaxes!(ax1a, ax2a, ax3a, ax1b, ax2b, ax3b, ax1c, ax2c, ax3c)
linkyaxes!(ax1a, ax2a, ax3a, ax1b, ax2b, ax3b, ax1c, ax2c, ax3c)

cb1.tellheight = true
cb2.tellheight = true

f
```